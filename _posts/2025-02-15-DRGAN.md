---
title: Disentangled Representation Learning GAN for Pose-Invariant Face Recognition
date: 2025-02-15 00:00:00 +0800 
categories: [论文] 
tags: [GAN]    
---

wos检索：

**"pose-invariant"** (Topic) and **recognition** (Topic) not **"Facial Expression"** (Topic)

**"POSE-INVARIANT FACE RECOGNITION"** (Topic) not **"Facial Expression"** (Topic)

## 算法实现

官方实现：

[tranluan/DR-GAN: DR-GAN Official Tensorflow Implementation (github.com)](https://github.com/tranluan/DR-GAN)

[Disentangled Representation Learning GAN for Pose-Invariant Face Recognition (msu.edu)](https://cvlab.cse.msu.edu/project-dr-gan.html)

其他实现：

1. [zhangjunh/DR-GAN-by-pytorch: An implement of Disentangled Representation Learning GAN for Pose-Invariant Face Recognition (github.com)](https://github.com/zhangjunh/DR-GAN-by-pytorch)
2. [Sampson-Lee/myDRGAN: Pytorch implimentation of《2017CVPR-Representation Learning by Rotating Your Faces》 (github.com)](https://github.com/Sampson-Lee/myDRGAN)
3. [kayamin/DR-GAN (github.com)](https://github.com/kayamin/DR-GAN)、[Dr-Gan源码-Pytorch_CSDNDRGAN代码资源-CSDN文库](https://download.csdn.net/download/qq_34914551/10959638)。代码在：`D:\Code\PythonCode\JupyterCode\DR-GAN\DR-GAN-master、Dr-Gan源码-Pytorch`


---


1. **解决的问题**：本文提出了一种名为Disentangled Representation Learning GAN（DR-GAN）的方法，旨在解决面部识别中的一个关键挑战：两个面部图像之间可能存在较大的姿态差异（即姿态不变性问题）。传统的面部识别方法通常通过正面化处理或从非正面面部图像中学习姿态不变性特征来解决这一问题。然而，本文作者认为，同时进行这两项任务可以更好地相互促进。

   "姿态不变性问题"（Pose-Invariant Face Recognition, PIFR）是指开发能够准确识别出不同姿态下的同一个人的面部识别技术

2. **为什么解决这个问题（必要性和价值）**： 面部识别技术在计算机视觉领域中非常重要，但姿态变化仍然是一个显著的挑战。研究表明，大多数算法在从正面到侧面的面部验证中性能下降超过10%，而人类的表现仅略有下降。这表明姿态变化仍然是面部识别中一个需要进一步研究的重要问题。通过解决这一问题，可以显著提高面部识别系统在实际应用中的准确性和可靠性，尤其是在监控和执法等场景中。

3. **如何解决**： DR-GAN通过以下几个创新点来解决姿态不变性面部识别问题：

   - 使用编码器-解码器结构的生成器，使DR-GAN能够学习到生成性和区分性表示，以及图像合成。
   - 通过解码器中的姿态码和鉴别器中的姿态估计，显式地将表示与姿态等其他面部变化分离。
   - DR-GAN可以接受一个或多个图像作为输入，并生成一个统一的表示以及任意数量的合成图像。
   - 提出了一种新颖的方案，基于学习到的系数自适应地融合多个面部图像到单一表示。

4. **得到的结果和答案**： 通过在控制环境和野外数据库上的定量和定性评估，DR-GAN显示出超越现有最先进技术的性能。具体结果包括：

   - 在Multi-PIE、CFP和IJB-A数据库上的面部识别性能达到了最先进的水平。
   - 通过实验设置，展示了在不同数量的训练和测试图像下，多图像DR-GAN相比于单图像DR-GAN在面部识别性能上的优势。
   - 通过与现有方法的比较，证明了DR-GAN在处理大姿态面部图像时的显著改进，并且在不同姿态下的识别率变化较小，表明学习到的表示对姿态变化更为鲁棒。
   - 在面部合成方面，DR-GAN能够生成逼真的正面面部图像，即使是从极端侧面视角的野外图像中也能成功进行正面化处理。



![](https://raw.githubusercontent.com/InTheFuture7/attachment/main/202510021122612.png)

| 变量名             | 解释                                                         |
| ------------------ | ------------------------------------------------------------ |
| $id$               | 人脸的唯一标识符，用于区分不同的人脸                         |
| $N^d$              | 表示人脸的姿态，用于在训练过程中对不同姿态的人脸进行分类     |
| $pose$             | 训练样本中人脸的角度                                         |
| $N^p$              | 取值为 9，表示每张人脸角度从 -60 到 +60，间隔 15°            |
| $N^z$              | 取值为 50，用于生成 noise $\mathbf{z}$                       |
| $\mathbf{x}$       | 输入的人脸图像                                               |
| $\mathbf{\hat{x}}$ | 生成的假图像                                                 |
| pose $\mathbf{c}$  | 姿态码（pose code），一个独热编码（one-hot vector）的向量，用于指定生成人脸的目标姿态 |
| $f(\mathbf{x})$    | 一维向量。图像 $\mathbf{x}$ 的特征表示，$f(\mathbf{x})=\mathbf{G}_{enc}(\mathbf{x})$ |
| noise $\mathbf{z}$ | 随机噪声向量，用于生成新的数据样本。生成服从均匀分布从 -1 到 1 的长度为 50 的向量 |
| $\mathbf{G}$       | 生成器（Generator），包含编码器（$\mathbf{G}_{enc}$）和解码器（$\mathbf{G}_{dec}$），用于生成指定姿态的人脸图像 |
| $\mathbf{D}$       | 判别器（Discriminator），用于区分真实人脸图像和生成器生成的图像 |





DR-GAN算法的流程可以概括为以下几个步骤：

1. **初始化网络**：初始化生成器（包含编码器Genc和解码器Gdec）和鉴别器D的网络参数。
2. **输入数据**：对于单图DR-GAN，输入单个面部图像；对于多图DR-GAN，输入属于同一人的多个面部图像。
3. **编码器Genc**：
   - 对于单图DR-GAN，将输入的面部图像编码为一个身份表示向量。
   - 对于多图DR-GAN，将每张输入图像编码为身份表示向量，并估计每个图像的置信系数。
4. **表示融合**（仅多图DR-GAN）：
   - 利用学习到的置信系数，将多个身份表示融合为一个统一的身份表示。
5. **解码器Gdec**：
   - 使用编码器输出的身份表示（单图DR-GAN）或融合的身份表示（多图DR-GAN），结合随机噪声向量z和姿态码c，解码生成目标姿态的面部图像。
6. **鉴别器D训练**：
   - 鉴别器D接收真实图像和生成器生成的假图像作为输入。
   - D的目标是区分真实图像和假图像，并预测它们的身份（Dd）和姿态（Dp）。
7. **生成器G训练**：
   - 生成器G接收编码器输出的身份表示、姿态码c和随机噪声z作为输入，目标是生成能够欺骗鉴别器D的假图像。
   - G同时更新编码器和解码器的参数，以生成更高质量的假图像，并使D难以区分真假。
8. **交替优化**：
   - 交替进行步骤6和7，即在优化D之后优化G，以此来训练生成器和鉴别器。
9. **评估**：
   - 使用学习到的表示进行面部识别评估，可以是控制环境下的数据库（如Multi-PIE）或野外环境（如CFP和IJB-A）。
10. **面部合成和识别**：
    - 使用训练好的DR-GAN模型，既可以进行面部合成，也可以进行姿态不变的面部识别。





**单图DR-GAN**

- 单图DR-GAN是基本模型，它接受单个图像作为输入。
- 该模型通过编码器-解码器结构的生成器学习面部图像的身份表示（identity representation），其中编码器的输出和解码器的输入是身份表示。
- 单图DR-GAN的目标是学习一个对姿态变化不变的面部身份表示，并合成具有相同身份但不同姿态的面部图像。
- 在训练过程中，单图DR-GAN使用一个编码器Genc和一个解码器Gdec，编码器从输入图像中学习身份表示，解码器使用该表示以及姿态码（pose code）和随机噪声向量z来合成目标姿态的面部图像。

| 组件     | 输入                                | 输出                     |
| -------- | ----------------------------------- | ------------------------ |
| **Genc** | 单个任意姿态的面部图像 𝑥            | 身份表示 𝑓(𝑥)            |
| **Gdec** | 身份表示 𝑓(𝑥)、姿态码 𝑐、随机噪声 𝑧 | 合成面部图像 𝑥^          |
| **D**    | 真实图像 𝑥 或合成图像 𝑥^            | 身份分类 𝐷𝑑、姿态分类 𝐷𝑝 |



**多图DR-GAN**

1. **特征提取**：Genc从同一个ID下的每个输入图像中学习到一个身份表示，并将这些表示结合起来形成一个融合的身份表示。
2. **置信系数估计**：Genc还为每个输入图像估计一个置信系数（ω），这个系数反映了每个图像对于学习身份表示的贡献程度。
3. **表示融合**：使用所有图像的置信系数加权平均，得到一个融合的身份表示，这个表示尽可能地包含了所有输入图像的信息。
4. **面部合成**：解码器（Gdec）使用融合的身份表示、一个姿态码（c）和一个随机噪声向量（z）来合成目标姿态的面部图像。

| 组件         | 输入                                  | 输出                        |
| ------------ | ------------------------------------- | --------------------------- |
| **Genc**     | 一组多个图像 {𝑥𝑖}𝑖=1𝑛{*x**i*}*i*=1*n* | 身份表示 𝑓(𝑥𝑖)、置信系数 𝜔𝑖 |
| **表示融合** | 加权的身份表示 𝜔𝑖⋅𝑓(𝑥𝑖)               | 融合的身份表示              |
| **Gdec**     | 融合的身份表示、姿态码 𝑐、随机噪声 𝑧  | 合成面部图像 𝑥^             |
| **D**        | 真实图像 𝑥 或合成图像 𝑥^              | 身份分类 𝐷𝑑、姿态分类 𝐷𝑝    |





论文同时提出两种dr-gan，分别是single-image和multi-image。这两个gan仅在损失函数和处理fx上不同。

其中single-image的过程就是上述说的那样，输入的就是batch_size，channel，height，width的tensor，意思是batch中的图像都独立的，没联系。

multi-image的输入shape是[n* batch_size,channels, height, width]，注意这个n意思是在一个mini batch中，同一个人脸有n张，有batch_size个人。先看同一个人的n张图像送进网络的过程。n张同一个人的脸通过encoder得到n个fx，需要一个fusion的过程，将这n个特征融合成一个特征。一种很容易想到的方法就是用1/n加权平均，论文并不是这么做的。再得到fx的同时，也用全连接层预测n个数字，代表了n个特征的confident coefficient（置信相关值？），用这n个值加权平均来得到最终的fx。



将一张或多张人脸图像作为输入，DR-GAN 可以在姿态代码指定的目标姿态下合成保持身份的人脸。

同时学习姿势不变的恒等表示和合成任意姿势的人脸





## 姿态不变

现有的姿态不变人脸识别大致分为两种策略：

1. 人脸正面化（Face Frontalization），借助传统的人脸识别方法合成一张正脸。
   
2. 通过一个关节模型（either one joint model）或多个特定姿势模型（multiple pose-specific models）直接从非正面面部学习判别特征（discriminative features）。





---



论文解释：

[DR-GAN：Disentangled Representation Learning GAN for Pose-Invariant Face Recognition论文解读_drgan-CSDN博客](https://blog.csdn.net/qq_34914551/article/details/87365119)

[paper2:Disentangled Representation Learning GAN for Pose-Invariant Face Recognition 2017 cvpr-CSDN博客](https://blog.csdn.net/qq_43118318/article/details/88353751)

[【论文阅读笔记】DR-GAN：改造生成器有效转正侧脸 - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/41992532)

[Disentangled Representation Learning GAN for Pose-Invariant Face Recognition - 简书 (jianshu.com)](https://www.jianshu.com/p/3edc9d48a417)

[DR-GAN (CVPR 2017, Disentangled Representation Learning GAN for Pose-Invariant Face Recognition)_drgan-CSDN博客](https://blog.csdn.net/yskyskyer123/article/details/103883276)









[Python版本与opencv版本的对应关系_opencv-python对应版本-CSDN博客](https://blog.csdn.net/m0_56312629/article/details/134830925)



测试数据集：

CFP、CASIA-WebFace、Multi-PIE、IJBA





pytorch==1.0.1

[Previous PyTorch Versions | PyTorch](https://pytorch.org/get-started/previous-versions/)



---



优先用 conda 下载



下载 Python 扩展包

明确 import 名和扩展包名的不同，比如：pytorch是包名，但是在下载时用命令 `pip/conda install torch`，导入该包时，用命令`import torch`



`conda install pkg_name`

到 [:: Anaconda.org](https://anaconda.org/) 查看，是否存在特定 platform 下的版本包。



`pip install pkg_name`

到 [PyPI · The Python Package Index](https://pypi.org/) 中查看，历史版本的包，或者下载 `.whl` 后离线下载



镜像源中是否有指定平台下的目标版本包：[Simple Index (tsinghua.edu.cn)](https://pypi.tuna.tsinghua.edu.cn/simple/)





扩展包官网：[Previous PyTorch Versions | PyTorch](https://pytorch.org/get-started/previous-versions/)